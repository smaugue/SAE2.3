<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Créer un trajet</title>

    <!-- Préconnecter les sources de Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        
    <!-- Police personnalisée -->
    <link href="https://fonts.googleapis.com/css2?family=Protest+Strike&family=Winky+Sans:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">    
    <!-- css -->
    <link rel="stylesheet" href="accueil.css">
</head>
<body>
    <div class="wrapper">
        <div class="content">
            <div class="menu">
                <div class="hamburger">&#9776;</div>
                <nav>
                    <ul>
                        <li><a href="accueil.html">Accueil</a></li>
                        <li><a href="propos.html">À propos</a></li>
                        <li><a href="#">Contact</a></li>
                        <li><a href="add_course.html">Programmer voyage</a></li> <!-- ✅ Nouveau lien -->
                        <li><a href="join_course.html">Rechercher voyage</a></li> <!-- ✅ Nouveau lien -->
                        <li><a href="php/logout.php">Se déconnecter</a></li>
                    </ul>
                </nav>
            </div>
            <div class="log">
            <h2>Crééer un nouveau trajet</h2></div><br><br><br>

                <form action="php/add_course.php" method="POST">

                    <div class="formulaire"><label>Lieu de départ :</label></div>
                    <select name="depart" id="select-depart" required>
                        <option value="">Chargement...</option>
                    </select><br><br>

                    <div class="formulaire"><label>Lieu d’arrivée :</label></div>
                    <select name="arrivee" id="select-arrivee" required>
                        <option value="">Chargement...</option>
                    </select><br><br>
                    
                    <div class="formulaire">
                    <label>Date et heure de départ :</label><br>
                    <input type="datetime-local" name="dh_depart" required><br><br>

                    <label>Date et heure d’arrivée :</label><br>
                    <input type="datetime-local" name="dh_arrivee" required><br><br>

                    <label>Prix (€)* :</label><br>
                    <input type="number" name="prix" min="0" required><br><br>

                    <input type="submit" value="Créer le trajet"></div>
                </form>
            
        </div>
    </div>

<script>
    // Fonction pour charger les lieux depuis le serveur
    async function chargerLieux() {
        const response = await fetch('php/get_lieux.php');
        print(response);
        const lieux = await response.json();

        const departSelect = document.getElementById('select-depart');
        const arriveeSelect = document.getElementById('select-arrivee');

        // On vide les listes avant de les remplir
        departSelect.innerHTML = '<option value="">-- Choisir --</option>';
        arriveeSelect.innerHTML = '<option value="">-- Choisir --</option>';


        // On ajoute les options pour chaque lieu
        lieux.forEach(lieu => {
            try {
            const option = document.createElement('option');
            option.value = lieu.id_lieux;
            option.textContent = `${lieu.Nom} (${lieu.Ville})`;
            departSelect.appendChild(option.cloneNode(true));
            arriveeSelect.appendChild(option);
            } catch (error) {
                console.error('Erreur lors de l\'ajout de l\'option :', error);
            }
        });
    }

    chargerLieux();
</script>

</body>
</html>
